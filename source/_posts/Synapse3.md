---
title: S3-完美匹配
date: 2021-08-24
tag: [number theory]
category: [Synapse]
math: true
---

Synapse 是一个专题笔记系列，每一篇的 topic 都是随机的，也许一些看似无关的笔记之间会产生某种联系

<!--more-->

## Menger's Theorem

设 $G$ 是一个有向简单图，$u,v$ 是 $G$ 中两个不相邻的顶点，$C$ 是 $u,v$ 之间的最小边割集，则 $|C|$ 等于 $u$ 到 $v$ 之间两两边独立的路径的数量。

我们称 $G$ 是 $k$-边连通图当且仅当 $G$ 中任意两点之间都可以找到 $k$ 条两两边独立的路径。

可以用最大流最小割定理推导出来。

## Hall's Theorem

定义：在二分图 $G=<V_1,V_2,E>$ 中，点集 $S \subseteq V_1$，称 $V_2$ 中与 $S$ 有边相连的点集 $\Gamma(S)$ 为 $S$ 的邻集。

**霍尔定理**：

设二分图 $G=<V_1,V_2,E>$，$|V_1|\le |V_2|$，则 $G$ 中存在 $V_1$ 到 $V_2$ 的完美匹配的充要条件是 $\forall S \subset V_1$，均有 $|S|\le |\Gamma(S)|$。

必要性是显然的，下面来证明充分性。

我们对 $V_1$ 的大小 $v$ 使用归纳法，$v=1$ 时显然成立，假设当 $v \le k$ 时成立，当 $v=k+1$ 时，可以分为两种情况：

一、若对于 $V_1$ 的**所有**非空子集 $S$，均满足 $|\Gamma(S)|\ge |S|+1$。那么我们可以从两边随便选一对点去匹配，剩下的部分依然满足霍尔定理，根据归纳假设，存在完美匹配。

二、若 $V_1$ 有部分非空子集 $T$ 满足 $|\Gamma(T)|=|T|$，我们令 $G_1=G[T\cup \Gamma(T)]$，$G_2=G\setminus G_1$。显然，$|G_1|=|\Gamma(G_1)|$，$|G_2|\le |\Gamma(G_2)|$，均满足霍尔定理，根据归纳假设，它们均能完美匹配。把这两个完美匹配并起来就是 $G$ 的完美匹配。

推论：设二分图 $G=<V_1,V_2,E>$，则 $G$ 的最大匹配为 $|V_1|-\max(|S|-|\Gamma(S)|)$，其中 $S$ 为 $V_1$ 的子集。

例题：[2017-2018 ACM-ICPC, Asia Daejeon Regional Contest](https://codeforces.com/gym/101667) J - Strongly Matchable

给出一个无向图 $G=<V,E>$，保证 $|V|$ 为不超过 $100$ 的偶数，问 $V$ 中所有大小为 $\dfrac{|V|}{2}$ 的子集 $S$ 是否均能与相应的 $V\setminus S$ 完美匹配。

根据霍尔定理，若存在点集 $U$ 满足 $|U|\le \dfrac{|V|}{2}$ 且 $|\Gamma(U)|\lt |U|$，就存在不完美匹配的情况。那么考虑这个 $U$，对应的 $|\Gamma(U)|\lt |U|\le \dfrac{V}{2}$，说明存在一个非空点集 $S=G\setminus U\setminus \Gamma(U)$，$U$ 与 $S$ 间不存在边。这就意味着 $\Gamma(U)$ 是 $G$ 的一个割！

于是我们只需要枚举源点和汇点，判断最小割是否小于 $\dfrac{|V|}{2}$ 即可。

## König's theorem(min-max theorem)

设二分图 $G=<V_1,V_2,E>$，则 $G$ 的最大匹配的边数等于最小顶点覆盖的顶点数。

在二分图中，最小顶点覆盖=最大匹配=最大流=最小割，而最大独立集等于顶点数-最小顶点覆盖。
