---
title: Elixir-SP1-é—ä¼ ç®—æ³•
date: 2026-02-24
tag: [Elixir]
category: [Software Engineering]
math: true
---

ç‰¹åˆ«ä¸“é¢˜ï¼šElixir çš„é—ä¼ ç®—æ³•

<!--more-->



é—ä¼ ç®—æ³•ï¼ˆGenetic Algorithm, GAï¼‰çš„ç§ç¾¤è¯„ä¼°å¤©ç„¶å°±æ˜¯â€œå°´å°¬å¹¶è¡Œï¼ˆEmbarrassingly Parallelï¼‰â€çš„ã€‚ç­‰ä½ å½»åº•æŒæ¡äº†çº¯å‡½æ•°å¼å†™æ³•ï¼Œæœªæ¥åªéœ€è¦æ”¹åŠ¨**ä¸€è¡Œä»£ç **ï¼Œå°±èƒ½è®©å®ƒç¬é—´å˜æˆå…¨æ ¸å¿ƒå¹¶å‘è¿è¡Œçš„ç‰ˆæœ¬ã€‚

GA çš„â€œHello Worldâ€â€”â€”**OneMax é—®é¢˜** å¼€å§‹ã€‚

ç›®æ ‡éå¸¸ç®€å•ï¼š**è®©ä¸€ä¸ªç”± 0 å’Œ 1 ç»„æˆçš„åˆ—è¡¨ï¼ˆæŸ“è‰²ä½“ï¼‰ï¼Œé€šè¿‡è¿›åŒ–ï¼Œå…¨éƒ¨å˜æˆ 1ã€‚**

ä½œä¸ºç®—æ³•è€æ‰‹ï¼ŒGA çš„é€»è¾‘ä½ é—­ç€çœ¼ç›éƒ½èƒ½å†™å‡ºæ¥ã€‚æ‰€ä»¥è¿™æ¬¡çš„é‡ç‚¹æ˜¯ï¼š**é€‚åº” Elixir çš„ä¸å¯å˜æ€§å’Œç®¡é“æ“ä½œç¬¦ï¼ˆ`|>`ï¼‰ã€‚**

æˆ‘ä¸ºä½ å‡†å¤‡äº†ä¸€ä¸ªå®Œæ•´çš„**ä»£ç éª¨æ¶ï¼ˆSkeletonï¼‰**ã€‚ä¸»å¾ªç¯å’ŒçŠ¶æ€ç©¿é€çš„è„šæ‰‹æ¶æˆ‘å·²ç»å¸®ä½ æ­å¥½äº†ï¼Œä½ åªéœ€è¦æŠŠé‡Œé¢å¸¦æœ‰ `# TODO:` çš„æ ¸å¿ƒç®—å­ï¼ˆç®—å­å…¨éƒ½æ˜¯çº¯å‡½æ•°ï¼‰å¡«ç©ºå¡«æ»¡å³å¯ï¼

### é—ä¼ ç®—æ³•éª¨æ¶ï¼š`genetic_algorithm.exs`

ä½ å¯ä»¥æ–°å»ºä¸€ä¸ªæ–‡ä»¶å« `genetic_algorithm.exs`ï¼ŒæŠŠä¸‹é¢çš„ä»£ç å¤åˆ¶è¿›å»ã€‚

ï¼ˆåœ¨ç»ˆç«¯è¿è¡Œ `elixir genetic_algorithm.exs` å³å¯æ‰§è¡Œï¼‰



```Elixir
defmodule GeneticAlgorithm do
  @moduledoc """
  çº¯å‡½æ•°å¼é—ä¼ ç®—æ³•æ±‚è§£ OneMax é—®é¢˜ã€‚
  ç›®æ ‡ï¼šè¿›åŒ–å‡ºä¸€ä¸ªå…¨ä¸º 1 çš„åˆ—è¡¨ã€‚
  """

  # ==========================================
  # è¶…å‚æ•°å®šä¹‰ (æ¨¡å—å±æ€§ï¼Œç±»ä¼¼ C++ çš„ #define)
  # ==========================================
  @pop_size 50
  @chromosome_length 20
  @mutation_rate 0.05
  @max_generations 100

  # ==========================================
  # ä¸»å…¥å£
  # ==========================================
  def run do
    IO.puts("ğŸš€ å¼€å§‹é—ä¼ ç®—æ³•è¿›åŒ–...")

    # 1. åˆå§‹åŒ–ç§ç¾¤ï¼šç”Ÿæˆ @pop_size ä¸ªæŸ“è‰²ä½“
    initial_population = initialize_population()

    # 2. å¯åŠ¨å°¾é€’å½’çŠ¶æ€æœºï¼Œåˆå§‹ä»£æ•°ä¸º 0
    # æ³¨æ„è¿™é‡Œï¼šæ²¡æœ‰ä»»ä½•å¯å˜çš„å…¨å±€çŠ¶æ€ï¼Œæ‰€æœ‰æ•°æ®éƒ½åœ¨å‚æ•°é‡ŒæµåŠ¨
    best_chromosome = evolve(initial_population, 0)

    IO.puts("\nğŸ‰ è¿›åŒ–ç»“æŸï¼")
    IO.puts("æœ€ä¼˜æŸ“è‰²ä½“: #{inspect(best_chromosome)}")
    IO.puts("æœ€ä¼˜é€‚åº”åº¦: #{fitness(best_chromosome)}")
  end

  # ==========================================
  # æ ¸å¿ƒè¿›åŒ–å¾ªç¯ (å°¾é€’å½’æ§åˆ¶æµ)
  # ==========================================
  
  # è¾¹ç•Œæ¡ä»¶ï¼šè¾¾åˆ°æœ€å¤§ä»£æ•°ï¼Œç»ˆæ­¢é€’å½’ï¼Œé€‰å‡ºå½“å‰ç§ç¾¤ä¸­æœ€å¥½çš„ä¸ªä½“è¿”å›
  defp evolve(population, @max_generations) do
    population
    |> Enum.max_by(&fitness/1)
  end

  # é€’å½’ä¸»å¹²ï¼šæ™®é€šä»£æ•°çš„è¿›åŒ–é€»è¾‘
  defp evolve(population, generation) do
    # æ‰“å°å½“å‰ä»£çš„æœ€ä½³é€‚åº”åº¦ï¼ˆè§‚å¯Ÿæ”¶æ•›è¿‡ç¨‹ï¼‰
    best = Enum.max_by(population, &fitness/1)
    IO.puts("Generation #{generation} | Best Fitness: #{fitness(best)}")

    # æå‰ç»ˆæ­¢æ¡ä»¶ï¼šå¦‚æœå·²ç»è¾¾åˆ°å®Œç¾é€‚åº”åº¦ï¼Œç›´æ¥è¿”å›
    if fitness(best) == @chromosome_length do
      best
    else
      # æ ¸å¿ƒæµæ°´çº¿ï¼šè¿™æ­£æ˜¯å‡½æ•°å¼ç¼–ç¨‹æœ€ä¼˜é›…çš„åœ°æ–¹ï¼
      # æ•°æ®å°±åƒåœ¨å·¥å‚æµæ°´çº¿ä¸€æ ·ï¼Œä»ä¸Šå¾€ä¸‹æµï¼Œä¸æ”¹å˜åŸæœ‰æ•°æ®ï¼Œåªç”Ÿæˆæ–°æ•°æ®
      next_generation =
        population
        |> evaluate_and_select()
        |> crossover()
        |> mutate()

      # å°¾é€’å½’è¿›å…¥ä¸‹ä¸€ä»£ï¼Œä¼ é€’æ–°çš„ç§ç¾¤å’Œä»£æ•° + 1
      evolve(next_generation, generation + 1)
    end
  end

  # ==========================================
  # å¾…å®ç°çš„ GA ç®—å­ (ä½ çš„ç»ƒä¹ åŒº)
  # ==========================================

  @doc "åˆå§‹åŒ–ç§ç¾¤ï¼šè¿”å›ä¸€ä¸ªåŒ…å« @pop_size ä¸ªæŸ“è‰²ä½“çš„åˆ—è¡¨ï¼Œæ¯ä¸ªæŸ“è‰²ä½“æ˜¯é•¿åº¦ä¸º @chromosome_length çš„ 0/1 åˆ—è¡¨"
  defp initialize_population do
    # æç¤ºï¼šä½ å¯ä»¥ä½¿ç”¨ for æ¨å¯¼å¼ï¼Œæˆ–è€… Enum.map ç»“åˆ :rand.uniform(2) - 1
    # TODO: è¯·å®ç°åˆå§‹åŒ–é€»è¾‘
    []
  end

  @doc "é€‚åº”åº¦å‡½æ•°ï¼šè®¡ç®—æŸ“è‰²ä½“ä¸­ 1 çš„ä¸ªæ•°"
  defp fitness(chromosome) do
    # æç¤ºï¼šç”¨ Enum.sum æˆ–è€… Enum.count æé€Ÿå®ç°
    # TODO: è¯·å®ç°é€‚åº”åº¦è®¡ç®—
    0
  end

  @doc "è¯„ä¼°ä¸é€‰æ‹©ï¼šä»å½“å‰ç§ç¾¤ä¸­é€‰å‡º @pop_size ä¸ªä¸ªä½“ç”¨äºç¹è¡"
  defp evaluate_and_select(population) do
    # é”¦æ ‡èµ›é€‰æ‹© (Tournament Selection) æ˜¯ä¸€ç§å¾ˆç®€å•ä¸”é€‚åˆå‡½æ•°å¼çš„å®ç°æ–¹æ³•ï¼š
    # éšæœºä»ç§ç¾¤æŠ½ 2 ä¸ªï¼Œå– fitness é«˜çš„é‚£ä¸ªï¼Œé‡å¤ @pop_size æ¬¡ã€‚
    # TODO: è¯·å®ç°é€‰æ‹©é€»è¾‘ï¼Œè¿”å›ä¸€ä¸ªä¸åŸç§ç¾¤å¤§å°ç›¸åŒçš„æ–°ç§ç¾¤åˆ—è¡¨
    population 
  end

  @doc "äº¤å‰ç®—å­ï¼šç›¸é‚»ä¸ªä½“ä¸¤ä¸¤é…å¯¹ï¼Œè¿›è¡Œå•ç‚¹äº¤å‰"
  defp crossover(population) do
    # æç¤ºï¼šå¯ä»¥ä½¿ç”¨ Enum.chunk_every(population, 2) å°†ç§ç¾¤ä¸¤ä¸¤åˆ†ç»„
    # ç„¶åç”¨ Enum.flat_map å¤„ç†æ¯ç»„ã€‚
    # åœ¨å¤„ç†äº¤å‰æ—¶ï¼Œä½¿ç”¨ Enum.split(list, index) å¯ä»¥æé€Ÿåˆ‡æ–­åˆ—è¡¨ã€‚
    # ç»“åˆæ¨¡å¼åŒ¹é…ï¼š 
    #   defp do_crossover([p1, p2]) do ... end
    #   defp do_crossover([p1]) do [p1] end # å¤„ç†è½å•çš„
    # TODO: è¯·å®ç°äº¤å‰é€»è¾‘
    population
  end

  @doc "å˜å¼‚ç®—å­ï¼šä»¥ @mutation_rate çš„æ¦‚ç‡ç¿»è½¬æŸ“è‰²ä½“ä¸Šçš„åŸºå› "
  defp mutate(population) do
    # æç¤ºï¼šå¯¹ç§ç¾¤ Enum.mapï¼Œå†å¯¹æ¯ä¸ªæŸ“è‰²ä½“ Enum.mapã€‚
    # åˆ¤æ–­ :rand.uniform() <= @mutation_rate æ¥å†³å®šæ˜¯å¦ç¿»è½¬ (1-x)ã€‚
    # TODO: è¯·å®ç°å˜å¼‚é€»è¾‘
    population
  end
end

# å¯åŠ¨ç¨‹åº
GeneticAlgorithm.run()
```

### æ ¸å¿ƒç»ƒä¹ ç›®æ ‡ï¼š

1. **ç»ƒä¹  `Enum` æ¨¡å—ï¼š** æŠ›å¼ƒ `for (int i=0; i<n; i++)` çš„æ€ç»´ï¼Œå°è¯•åœ¨ `initialize_population`ã€`fitness` å’Œ `mutate` ä¸­ä½¿ç”¨ `Enum.map`ã€`Enum.sum` æˆ–åˆ—è¡¨æ¨å¯¼å¼ï¼ˆ`for x <- list, do: ...`ï¼‰ã€‚

2. **ç»ƒä¹ æ¨¡å¼åŒ¹é…ï¼š** åœ¨ `crossover` ä¸­ï¼Œä½ å¯èƒ½ä¼šé‡åˆ°ä¼ è¿›æ¥çš„æ˜¯é•¿åº¦ä¸º 2 çš„åˆ—è¡¨ï¼ˆå¯ä»¥äº¤é…ï¼‰ï¼Œæˆ–è€…é•¿åº¦ä¸º 1 çš„åˆ—è¡¨ï¼ˆè½å•çš„ï¼Œç›´æ¥ä¿ç•™ï¼‰ã€‚ç”¨å¤šé‡å‡½æ•°ç­¾åï¼ˆFunction Clausesï¼‰æ¥ä¼˜é›…åœ°å¤„ç†å®ƒä»¬ï¼š

   Elixir

   ```
   defp do_crossover([parent1, parent2]) do ... end
   defp do_crossover([single]) do [single] end
   ```

3. **ä½“ä¼šä¸å¯å˜æ€§ï¼š** æ³¨æ„åœ¨ä½ çš„ç®—å­ä¸­ï¼Œä½ ä¸éœ€è¦ï¼ˆä¹Ÿä¸å¯èƒ½ï¼‰å»ä¿®æ”¹ä¼ è¿›æ¥çš„ `population` åˆ—è¡¨ã€‚ä½ æ‰€åšçš„ï¼Œæ°¸è¿œæ˜¯æ„é€ å¹¶è¿”å›ä¸€ä¸ª**å…¨æ–°çš„åˆ—è¡¨**ã€‚



